name: 'Determine Semantic Version'
description: 'Reusable action to compute semantic version from major/minor and latest tag.'
runs:
  using: "composite"
  steps:
    - name: Determine semantic version
      id: semver
      run: |
        major=${{ inputs.major }}
        minor=${{ inputs.minor }}
        prefix="$major.$minor."
        latest_tag=$(git tag --list "$prefix*" | sort -V | tail -n1)
        if [[ -z "$latest_tag" ]]; then
          patch=1
        else
          patch=$(echo "$latest_tag" | awk -F. '{print $3+1}')
        fi
        version="$major.$minor.$patch"
        echo "Computed version: $version"
        echo "version=$version" >> $GITHUB_OUTPUT
      shell: bash
inputs:
  major:
    description: 'Major version number'
    required: true
  minor:
    description: 'Minor version number'
    required: true
outputs:
  version:
    description: 'Computed semantic version'
    value: ${{ steps.semver.outputs.version }}

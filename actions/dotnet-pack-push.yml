name: 'Dotnet Pack and Push'
description: 'Reusable action to pack a .NET project and push the resulting NuGet package to a specified feed.'
runs:
  using: "composite"
  steps:
    - name: Pack NuGet package
      run: |
        if [ -z "${{ inputs.version }}" ]; then
          dotnet pack ${{ inputs.project }} --configuration ${{ inputs.configuration }} --no-build --output ./nupkg
        else
          dotnet pack ${{ inputs.project }} --configuration ${{ inputs.configuration }} --no-build --output ./nupkg /p:Version=${{ inputs.version }}
        fi
      shell: bash
    - name: Push NuGet package
      run: dotnet nuget push ./nupkg/*.nupkg --api-key ${{ inputs.api-key }} --source ${{ inputs.nuget-source }}
      shell: bash
inputs:
  project:
    description: 'Path to the .csproj file to pack'
    required: true
  configuration:
    description: 'Build configuration'
    required: false
    default: 'Release'
  version:
    description: 'Semantic version for the NuGet package'
    required: false
  api-key:
    description: 'API key for the NuGet feed'
    required: true
  nuget-source:
    description: 'NuGet feed/source URL'
    required: true
